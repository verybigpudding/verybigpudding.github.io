<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>我不要</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-3">
  <div class="container">

    <!-- 衣服選擇 -->
    <div class="mb-3">
      <label class="form-label">衣服</label>
      <button id="cloth450" class="btn btn-outline-primary me-2" onclick="selectClothes(450, 'cloth450')">$450</button>
      <button id="cloth600" class="btn btn-outline-primary" onclick="selectClothes(600, 'cloth600')">$600</button>
    </div>

    <!-- 小圖 -->
    <div class="d-flex align-items-center mb-3">
      <span class="me-3">小圖 ($150)</span>
      <button class="btn btn-outline-secondary me-2" onclick="updateItem('smallPic', -1)">-</button>
      <span id="smallPic" class="me-2">0</span>
      <button class="btn btn-outline-secondary" onclick="updateItem('smallPic', 1)">+</button>
    </div>

    <!-- 大圖 -->
    <div class="d-flex align-items-center mb-3">
      <span class="me-3">大圖 ($250)</span>
      <button class="btn btn-outline-secondary me-2" onclick="updateItem('bigPic', -1)">-</button>
      <span id="bigPic" class="me-2">0</span>
      <button class="btn btn-outline-secondary" onclick="updateItem('bigPic', 1)">+</button>
    </div>

    <!-- 顏色 -->
    <div class="d-flex align-items-center mb-3">
      <span class="me-3">顏色 ($50)</span>
      <button class="btn btn-outline-secondary me-2" onclick="updateItem('color', -1)">-</button>
      <span id="color" class="me-2">0</span>
      <button class="btn btn-outline-secondary" onclick="updateItem('color', 1)">+</button>
    </div>

    <!-- 文字 -->
    <div class="d-flex align-items-center mb-3">
      <span class="me-3">文字 ($30)</span>
      <button class="btn btn-outline-secondary me-2" onclick="updateItem('text', -1)">-</button>
      <span id="text" class="me-2">0</span>
      <button class="btn btn-outline-secondary" onclick="updateItem('text', 1)">+</button>
    </div>

    <!-- 總金額 -->
    <div class="mt-4">
      <h4>總金額: <span id="total">0</span></h4>
      <button class="btn btn-primary mt-2" onclick="confirmOrder()">確定</button>
    </div>

    <div id="history" class="mt-4"></div>

    <button id="toggleCalc" class="btn btn-secondary mt-3">計算機</button>

  </div>

  <script>
    let clothesPrice = 0;
    let selectedClothBtn = null;

    let items = {
      smallPic: 0,
      bigPic: 0,
      color: 0,
      text: 0
    };

    const prices = {
      smallPic: 150,
      bigPic: 250,
      color: 50,
      text: 30
    };

    function selectClothes(price, btnId) {
      clothesPrice = price;

      if (selectedClothBtn) {
        document.getElementById(selectedClothBtn).classList.remove("btn-primary");
        document.getElementById(selectedClothBtn).classList.add("btn-outline-primary");
      }

      document.getElementById(btnId).classList.remove("btn-outline-primary");
      document.getElementById(btnId).classList.add("btn-primary");

      selectedClothBtn = btnId;

      updateTotal();
    }

    function updateItem(type, change) {
      if (items[type] + change >= 0) {
        items[type] += change;
        document.getElementById(type).innerText = items[type];
        updateTotal();
      }
    }

    function updateTotal() {
      let total = clothesPrice;

      // 計算小圖
      if (clothesPrice > 0 && items.smallPic > 0) {
        total += (items.smallPic - 1) * prices.smallPic; // 第一張免費
      } else {
        total += items.smallPic * prices.smallPic;
      }

      if (items.bigPic > 0) {
        if (clothesPrice > 0 && items.smallPic === 0) {
          total += 100 + (items.bigPic - 1) * prices.bigPic;
        } else {
          total += items.bigPic * prices.bigPic;
        }
      }

      total += items.color * prices.color;
      total += items.text * prices.text;

      document.getElementById("total").innerText = total;
      return total;
    }


    function confirmOrder() {
      let total = updateTotal();

      if (total > 0) {
        const historyDiv = document.getElementById("history");
        const record = document.createElement("div");
        record.innerText = `這件是$${total}！`;
        historyDiv.prepend(record);
      }

      clothesPrice = 0;
      if (selectedClothBtn) {
        document.getElementById(selectedClothBtn).classList.remove("btn-primary");
        document.getElementById(selectedClothBtn).classList.add("btn-outline-primary");
        selectedClothBtn = null;
      }
      for (let key in items) {
        items[key] = 0;
        document.getElementById(key).innerText = 0;
      }

      updateTotal();
    }
  </script>


  <div id="calculator" class="mt-3" style="display:none;">
    <div class="border rounded p-3" style="max-width: 250px;">
      <div id="calc-display" class="border mb-2 p-2 text-end" style="height:40px; font-size:18px; overflow-x:auto;">
        0
      </div>
      <div class="d-grid gap-2">
        <div class="d-flex">
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('7')">7</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('8')">8</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('9')">9</button>
          <button class="btn btn-info flex-fill" onclick="pressCalc('/')">÷</button>
        </div>
        <div class="d-flex">
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('4')">4</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('5')">5</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('6')">6</button>
          <button class="btn btn-info flex-fill" onclick="pressCalc('*')">×</button>
        </div>
        <div class="d-flex">
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('1')">1</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('2')">2</button>
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('3')">3</button>
          <button class="btn btn-info flex-fill" onclick="pressCalc('-')">-</button>
        </div>
        <div class="d-flex">
          <button class="btn btn-secondary flex-fill" onclick="pressCalc('0')">0</button>
          <button class="btn btn-primary flex-fill" onclick="clearCalc()">C</button>
          <button class="btn btn-primary flex-fill" onclick="calculate()">=</button>
          <button class="btn btn-info flex-fill" onclick="pressCalc('+')">+</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let calcInput = "";

    function pressCalc(val) {
      if (calcInput === "0") calcInput = "";
      calcInput += val;
      document.getElementById("calc-display").innerText = calcInput;
    }

    function calculate() {
      try {
        let result = eval(calcInput);
        document.getElementById("calc-display").innerText = result;
        calcInput = result.toString();
      } catch {
        document.getElementById("calc-display").innerText = "錯誤";
        calcInput = "";
      }
    }

    function clearCalc() {
      calcInput = "";
      document.getElementById("calc-display").innerText = "0";
    }

    const toggleCalcBtn = document.getElementById('toggleCalc');
    const calculatorDiv = document.getElementById('calculator');

    toggleCalcBtn.addEventListener('click', () => {
      calculatorDiv.style.display = calculatorDiv.style.display === 'none' ? 'block' : 'none';
    });
  </script>

</body>

</html>